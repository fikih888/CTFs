### c0r0n4con CTF 2020

##### Challenge: RSA Baby

##### Category: Crypto

##### Points: 100

##### Solves: 102/362

##### Description: RSA is your quarantine's friend!

En este reto nos dan los valores "n, e1, e2, c1 y c2", los cuales se corresponden a un cifrado RSA de la siguiente manera:
- n: módulo común entre las dos claves públicas
- e1: exponente de la clave pública 1
- e2: exponente de la clave pública 2
- c1: mensaje "M" cifrado con la clave 1
- c2: mensaje "M" cifrado con la clave 2

En este caso, vemos que es un mismo mensaje cifrado con dos claves distintas que comparten el mismo módulo. Asi que procedemos a crear un script sabiendo que podemos llegar a obtener el mensaje en claro "M" de dos textos iguales cifrados con el mismo módulo pero con diferente exponente si el máximo común divisor de estos módulos es 1:
```python
from libnum import *

n= 139139098166563368793906426353584775685986156985503895898108450666153804152721077328595298405359402968586164698349127474583831260369056674398122221948323174927823244488759235828048733639655945179009496153393829487742364880448642168094375012523825513069073691277215422154080122721414171233541059159461497574851
e1= 8589547526045561461552680248279757835979283889671962732842177455697481270376746567989084136626965959183030099272662143191917717068451310686662922269968037
e2= 1550875426281080713285640421891864359643668278531602865211049325478612197772168543099328132747062677256718488137967707434694189218634201660188716505159465
c1= 36251028222184669113487409017454975826565106104917435244458509025325597595097437837292486054294655693705631371301937875354932194238774646471806718003961847732817524682493697446263462385101163784046225206169381882321268194820701612704489320707217757417267296259559235617734319007884212443563740615946094992859
c2= 15688769307556061961218947783212296596344168555685824671642275978089568687312912139032947498393471032926950577032514983014105921115080590723699988614214232859981728991429978617821297278877767993295441070537327281816259747634098763766785395724275437311610210946257742159892825472332345447909363995349523623705

#Max comun divisor es 1
assert gcd(e1, e2) == 1

#Algoritmo de Euclides extendido
u, v, z = xgcd(e1, e2)
#como v es negativo, calculamos su inverso
c2_inv = invmod(c2, n)

#Identidad de Bezout
m1 = pow(c1, u, n)
v = -1 * v
m2 = pow(c2_inv, v, n)
M = (m1 * m2) % n

#Pasamos de hex a ASCII
print(hex(M)[2:-1].decode('hex'))
```
Tras ejecutarlo se obtiene el siguiente mensaje que se corresponde al flag:
```
flag{C0mm0n_m0duluS_4tt4cK_f0R_k1ll_COVID-19}
```

**Nota:** Dejo un par de links por si se quiere más info sobre el "ataque": "https://rootfs.eu/codeblue2017-common-modulus/" y "https://bitsdeep.com/posts/attacking-rsa-for-fun-and-ctf-points-part-1/"

